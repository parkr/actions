on: push
name: Build on push
jobs:
  buildAndTestActions:
    name: Build & Test Custom Actions
    runs-on: ubuntu-latest
    permissions:
      packages: write
    steps:
    - uses: actions/checkout@master
    - name: Build & Test docker-auth
      uses: ./docker-auth
      with:
        args: login
      env:
        DOCKER_REGISTRY_URL: ghcr.io
        DOCKER_USERNAME: parkr
        DOCKER_PASSWORD: ${secrets.GITHUB_TOKEN}
    - name: Build & Test docker-make
      uses: ./docker-make
      with:
        args: test-test-image
    - name: Log out of ghcr.io
      uses: ./docker-auth
      with:
        args: logout
